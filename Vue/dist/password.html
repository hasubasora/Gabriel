<html>

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="framework\layer.css">
<link rel="stylesheet" href="stylesheets\main.css">
<script src="framework\jquery-2.2.1.min.js"></script>
<script src="framework\layer.js"></script>
<script src="javascripts\filters.js"></script>

    <title>密码页面</title>
</head>

<body>

    <section>
        <div class="pwd">
            <input type="password" name="" id="password" placeholder="请输入8位以上的密码">
            <input type="password" name="" id="password2" placeholder="重复密码">
            <button type="button" class="reg register" id="reg">注册</button>
            <p>轻触上面“注册”按钮，即表示你已阅读并同意<a href="">《服务协议》</a></p>

        </div>
    </section>


</body>
<script>
    $(function() {
        // var doc = document.getElementById('reg');
        // doc.onclick = function() {
        //     window.location.href = qrCodeSucess;
        // }

        one.init();
    })

    var one = {
        init: function() {
            _t = this;
            //点击注册
            $('#reg').on('touchstart', function() {
                var r_len = _t.len($('#password').val(), $('#password2').val());
                // alert(r_len);
                if (r_len) {
                    var r_dblen = _t.dblen($('#password').val(), $('#password2').val());
                    // alert(r_dblen);
                    if (r_dblen) {
                        $.ajax({
                            url: registerUrl,
                            type: 'post',
                            dataType: 'json',
                            data: {
                                pwd: $('#password').val()
                            },
                            success: function(result) {
                                console.log(result);
                                window.location.href = qrCodeSucess;
                            },
                            error: function() {
                                layer.open({
                                    content: '你进入了没有网络的异次元世界！',
                                    skin: 'msg',
                                    time: 2 //2秒后自动关闭
                                });
                                return false;
                            }
                        })
                    }
                }

            })
        },
        len: function(p, p2) {
            console.log(p)
            if (!p) {
                layer.open({
                    content: '请输入密码！',
                    skin: 'msg',
                    time: 2 //2秒后自动关闭
                });
                return false;
            } else if (p.length < 8) {
                layer.open({
                    content: '密码长度不够！',
                    skin: 'msg',
                    time: 2 //2秒后自动关闭
                });
                return false;
            } else if (!p2) {
                layer.open({
                    content: '请重复密码！',
                    skin: 'msg',
                    time: 2 //2秒后自动关闭
                });
                return false;
            }
            return true;
        },
        dblen: function(p, p2) {
            if (p.length > 8) {
                if (p != p2) {
                    layer.open({
                        content: '两次密码不一致',
                        skin: 'msg',
                        time: 2 //2秒后自动关闭
                    });
                    return false;
                }

                if (p == p2) {
                    return true;
                }
            }
            if (p.length != p2.length) {
                layer.open({
                    content: '两次密码不一致',
                    skin: 'msg',
                    time: 2 //2秒后自动关闭
                });
                return false;
            }
            return false;

        }
    }
</script>

</html>